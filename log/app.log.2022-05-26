2022-05-26 00:41:27,204, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 00:41:27,287, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 00:41:27,367, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 00:41:27,447, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 01:15:08,844, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 01:15:11,723, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 01:15:23,793, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 11:16:04,582, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 11:16:04,757, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 11:21:50,039, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 14:00:57,103, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 14:00:57,277, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 14:30:52,874, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 14:31:38,636, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 14:34:45,610, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 14:34:46,388, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 14:34:51,037, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 14:36:20,651, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 15:40:43,725, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 15:50:36,263, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 15:58:27,953, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 16:35:22,181, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 63, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 184, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 372, in get_hist_message
    query = db.query(models.Message).filter(models.Message.topicid== topicid)
AttributeError: type object 'Message' has no attribute 'topicid'
2022-05-26 16:35:22,222, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 63, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "/data1/work/repos/light_chat/main.py", line 217, in pop_message
    rst = await dal.pop_user_message(db, current_userid, start_id)
  File "/data1/work/repos/light_chat/dal.py", line 419, in pop_user_message
    msg_cnt = _get_hist_message_count(db, userid, visiable)
  File "/data1/work/repos/light_chat/dal.py", line 336, in _get_hist_message_count
    query = db.query(sqlalchemy.func.count(models.Message.id)).filter(models.Message.topicid== topicid)
AttributeError: type object 'Message' has no attribute 'topicid'
2022-05-26 16:35:38,089, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 63, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 184, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 372, in get_hist_message
    query = db.query(models.Message).filter(models.Message.topicid== topicid)
AttributeError: type object 'Message' has no attribute 'topicid'
2022-05-26 16:35:38,180, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 63, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "/data1/work/repos/light_chat/main.py", line 217, in pop_message
    rst = await dal.pop_user_message(db, current_userid, start_id)
  File "/data1/work/repos/light_chat/dal.py", line 419, in pop_user_message
    msg_cnt = _get_hist_message_count(db, userid, visiable)
  File "/data1/work/repos/light_chat/dal.py", line 336, in _get_hist_message_count
    query = db.query(sqlalchemy.func.count(models.Message.id)).filter(models.Message.topicid== topicid)
AttributeError: type object 'Message' has no attribute 'topicid'
2022-05-26 16:59:30,068, DEBUG Starting new HTTP connection (1): 127.0.0.1:8080
2022-05-26 16:59:33,574, DEBUG http://127.0.0.1:8080 "POST /api/v0/generate HTTP/1.1" 200 155
2022-05-26 16:59:40,631, DEBUG Starting new HTTP connection (1): 127.0.0.1:8080
2022-05-26 16:59:44,025, DEBUG http://127.0.0.1:8080 "POST /api/v0/generate HTTP/1.1" 200 332
2022-05-26 17:10:53,601, WARNING StatReload detected file change in 'main.py'. Reloading...
2022-05-26 17:10:53,701, INFO Shutting down
2022-05-26 17:10:53,802, INFO Waiting for application shutdown.
2022-05-26 17:10:53,803, INFO Application shutdown complete.
2022-05-26 17:10:53,803, INFO Finished server process [4035045]
2022-05-26 17:10:56,044, DEBUG Using selector: EpollSelector
2022-05-26 17:10:56,189, INFO Started server process [1323838]
2022-05-26 17:10:56,189, INFO Started server process [1323838]
2022-05-26 17:10:56,189, INFO Waiting for application startup.
2022-05-26 17:10:56,189, INFO Waiting for application startup.
2022-05-26 17:10:56,190, INFO Application startup complete.
2022-05-26 17:10:56,190, INFO Application startup complete.
2022-05-26 17:11:05,212, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 63, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "/data1/work/repos/light_chat/main.py", line 217, in pop_message
    rst = await dal.pop_user_message(db, current_userid, start_id)
  File "/data1/work/repos/light_chat/dal.py", line 419, in pop_user_message
    msg_cnt = _get_hist_message_count(db, userid, visiable)
  File "/data1/work/repos/light_chat/dal.py", line 336, in _get_hist_message_count
    query = db.query(sqlalchemy.func.count(models.Message.id)).filter(models.Message.topicid== topicid)
AttributeError: type object 'Message' has no attribute 'topicid'
2022-05-26 17:11:05,212, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 63, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "/data1/work/repos/light_chat/main.py", line 217, in pop_message
    rst = await dal.pop_user_message(db, current_userid, start_id)
  File "/data1/work/repos/light_chat/dal.py", line 419, in pop_user_message
    msg_cnt = _get_hist_message_count(db, userid, visiable)
  File "/data1/work/repos/light_chat/dal.py", line 336, in _get_hist_message_count
    query = db.query(sqlalchemy.func.count(models.Message.id)).filter(models.Message.topicid== topicid)
AttributeError: type object 'Message' has no attribute 'topicid'
2022-05-26 17:11:05,219, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 63, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 184, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 372, in get_hist_message
    query = db.query(models.Message).filter(models.Message.topicid== topicid)
AttributeError: type object 'Message' has no attribute 'topicid'
2022-05-26 17:11:05,219, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 63, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 184, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 372, in get_hist_message
    query = db.query(models.Message).filter(models.Message.topicid== topicid)
AttributeError: type object 'Message' has no attribute 'topicid'
2022-05-26 17:11:23,289, WARNING StatReload detected file change in 'main.py'. Reloading...
2022-05-26 17:11:23,293, INFO Shutting down
2022-05-26 17:11:23,293, INFO Shutting down
2022-05-26 17:11:23,394, INFO Waiting for application shutdown.
2022-05-26 17:11:23,394, INFO Waiting for application shutdown.
2022-05-26 17:11:23,394, INFO Application shutdown complete.
2022-05-26 17:11:23,394, INFO Application shutdown complete.
2022-05-26 17:11:23,395, INFO Finished server process [1323838]
2022-05-26 17:11:23,395, INFO Finished server process [1323838]
2022-05-26 17:11:25,511, DEBUG Using selector: EpollSelector
2022-05-26 17:11:25,664, INFO Started server process [1324574]
2022-05-26 17:11:25,664, INFO Started server process [1324574]
2022-05-26 17:11:25,664, INFO Waiting for application startup.
2022-05-26 17:11:25,664, INFO Waiting for application startup.
2022-05-26 17:11:25,665, INFO Application startup complete.
2022-05-26 17:11:25,665, INFO Application startup complete.
2022-05-26 17:11:37,017, WARNING StatReload detected file change in 'main.py'. Reloading...
2022-05-26 17:11:37,092, INFO Shutting down
2022-05-26 17:11:37,092, INFO Shutting down
2022-05-26 17:11:37,193, INFO Waiting for application shutdown.
2022-05-26 17:11:37,193, INFO Waiting for application shutdown.
2022-05-26 17:11:37,194, INFO Application shutdown complete.
2022-05-26 17:11:37,194, INFO Application shutdown complete.
2022-05-26 17:11:37,194, INFO Finished server process [1324574]
2022-05-26 17:11:37,194, INFO Finished server process [1324574]
2022-05-26 17:11:39,253, DEBUG Using selector: EpollSelector
2022-05-26 17:11:39,372, INFO Started server process [1324944]
2022-05-26 17:11:39,372, INFO Started server process [1324944]
2022-05-26 17:11:39,373, INFO Waiting for application startup.
2022-05-26 17:11:39,373, INFO Waiting for application startup.
2022-05-26 17:11:39,373, INFO Application startup complete.
2022-05-26 17:11:39,373, INFO Application startup complete.
2022-05-26 17:11:42,494, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 372, in get_hist_message
    query = db.query(models.Message).filter(models.Message.topicid== topicid)
AttributeError: type object 'Message' has no attribute 'topicid'
2022-05-26 17:11:42,494, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 372, in get_hist_message
    query = db.query(models.Message).filter(models.Message.topicid== topicid)
AttributeError: type object 'Message' has no attribute 'topicid'
2022-05-26 17:11:42,539, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "/data1/work/repos/light_chat/main.py", line 214, in pop_message
    rst = await dal.pop_user_message(db, current_userid, start_id)
  File "/data1/work/repos/light_chat/dal.py", line 419, in pop_user_message
    msg_cnt = _get_hist_message_count(db, userid, visiable)
  File "/data1/work/repos/light_chat/dal.py", line 336, in _get_hist_message_count
    query = db.query(sqlalchemy.func.count(models.Message.id)).filter(models.Message.topicid== topicid)
AttributeError: type object 'Message' has no attribute 'topicid'
2022-05-26 17:11:42,539, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "/data1/work/repos/light_chat/main.py", line 214, in pop_message
    rst = await dal.pop_user_message(db, current_userid, start_id)
  File "/data1/work/repos/light_chat/dal.py", line 419, in pop_user_message
    msg_cnt = _get_hist_message_count(db, userid, visiable)
  File "/data1/work/repos/light_chat/dal.py", line 336, in _get_hist_message_count
    query = db.query(sqlalchemy.func.count(models.Message.id)).filter(models.Message.topicid== topicid)
AttributeError: type object 'Message' has no attribute 'topicid'
2022-05-26 17:11:53,569, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 372, in get_hist_message
    query = db.query(models.Message).filter(models.Message.topicid== topicid)
AttributeError: type object 'Message' has no attribute 'topicid'
2022-05-26 17:11:53,569, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 372, in get_hist_message
    query = db.query(models.Message).filter(models.Message.topicid== topicid)
AttributeError: type object 'Message' has no attribute 'topicid'
2022-05-26 17:11:53,784, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "/data1/work/repos/light_chat/main.py", line 214, in pop_message
    rst = await dal.pop_user_message(db, current_userid, start_id)
  File "/data1/work/repos/light_chat/dal.py", line 419, in pop_user_message
    msg_cnt = _get_hist_message_count(db, userid, visiable)
  File "/data1/work/repos/light_chat/dal.py", line 336, in _get_hist_message_count
    query = db.query(sqlalchemy.func.count(models.Message.id)).filter(models.Message.topicid== topicid)
AttributeError: type object 'Message' has no attribute 'topicid'
2022-05-26 17:11:53,784, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "/data1/work/repos/light_chat/main.py", line 214, in pop_message
    rst = await dal.pop_user_message(db, current_userid, start_id)
  File "/data1/work/repos/light_chat/dal.py", line 419, in pop_user_message
    msg_cnt = _get_hist_message_count(db, userid, visiable)
  File "/data1/work/repos/light_chat/dal.py", line 336, in _get_hist_message_count
    query = db.query(sqlalchemy.func.count(models.Message.id)).filter(models.Message.topicid== topicid)
AttributeError: type object 'Message' has no attribute 'topicid'
2022-05-26 17:15:48,143, WARNING StatReload detected file change in 'db/models.py'. Reloading...
2022-05-26 17:15:48,195, INFO Shutting down
2022-05-26 17:15:48,195, INFO Shutting down
2022-05-26 17:15:48,296, INFO Waiting for application shutdown.
2022-05-26 17:15:48,296, INFO Waiting for application shutdown.
2022-05-26 17:15:48,297, INFO Application shutdown complete.
2022-05-26 17:15:48,297, INFO Application shutdown complete.
2022-05-26 17:15:48,297, INFO Finished server process [1324944]
2022-05-26 17:15:48,297, INFO Finished server process [1324944]
2022-05-26 17:15:50,370, DEBUG Using selector: EpollSelector
2022-05-26 17:15:50,466, INFO Started server process [1331465]
2022-05-26 17:15:50,466, INFO Started server process [1331465]
2022-05-26 17:15:50,466, INFO Waiting for application startup.
2022-05-26 17:15:50,466, INFO Waiting for application startup.
2022-05-26 17:15:50,467, INFO Application startup complete.
2022-05-26 17:15:50,467, INFO Application startup complete.
2022-05-26 17:16:07,464, WARNING StatReload detected file change in 'db/models.py'. Reloading...
2022-05-26 17:16:07,511, INFO Shutting down
2022-05-26 17:16:07,511, INFO Shutting down
2022-05-26 17:16:07,611, INFO Waiting for application shutdown.
2022-05-26 17:16:07,611, INFO Waiting for application shutdown.
2022-05-26 17:16:07,612, INFO Application shutdown complete.
2022-05-26 17:16:07,612, INFO Application shutdown complete.
2022-05-26 17:16:07,612, INFO Finished server process [1331465]
2022-05-26 17:16:07,612, INFO Finished server process [1331465]
2022-05-26 17:16:09,688, DEBUG Using selector: EpollSelector
2022-05-26 17:16:09,782, INFO Started server process [1331963]
2022-05-26 17:16:09,782, INFO Started server process [1331963]
2022-05-26 17:16:09,782, INFO Waiting for application startup.
2022-05-26 17:16:09,782, INFO Waiting for application startup.
2022-05-26 17:16:09,782, INFO Application startup complete.
2022-05-26 17:16:09,782, INFO Application startup complete.
2022-05-26 17:16:12,031, WARNING StatReload detected file change in 'dal.py'. Reloading...
2022-05-26 17:16:12,089, INFO Shutting down
2022-05-26 17:16:12,089, INFO Shutting down
2022-05-26 17:16:12,189, INFO Waiting for application shutdown.
2022-05-26 17:16:12,189, INFO Waiting for application shutdown.
2022-05-26 17:16:12,190, INFO Application shutdown complete.
2022-05-26 17:16:12,190, INFO Application shutdown complete.
2022-05-26 17:16:12,190, INFO Finished server process [1331963]
2022-05-26 17:16:12,190, INFO Finished server process [1331963]
2022-05-26 17:16:14,197, DEBUG Using selector: EpollSelector
2022-05-26 17:16:14,294, INFO Started server process [1332128]
2022-05-26 17:16:14,294, INFO Started server process [1332128]
2022-05-26 17:16:14,294, INFO Waiting for application startup.
2022-05-26 17:16:14,294, INFO Waiting for application startup.
2022-05-26 17:16:14,294, INFO Application startup complete.
2022-05-26 17:16:14,294, INFO Application startup complete.
2022-05-26 17:16:19,106, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "/data1/work/repos/light_chat/main.py", line 214, in pop_message
    rst = await dal.pop_user_message(db, current_userid, start_id)
  File "/data1/work/repos/light_chat/dal.py", line 471, in pop_user_message
    return _pop_user_message(db, db_user, start_id, visiable)
  File "/data1/work/repos/light_chat/dal.py", line 405, in _pop_user_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:16:19,106, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "/data1/work/repos/light_chat/main.py", line 214, in pop_message
    rst = await dal.pop_user_message(db, current_userid, start_id)
  File "/data1/work/repos/light_chat/dal.py", line 471, in pop_user_message
    return _pop_user_message(db, db_user, start_id, visiable)
  File "/data1/work/repos/light_chat/dal.py", line 405, in _pop_user_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:19:10,001, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:19:10,001, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:24:27,040, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:24:27,040, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:24:34,891, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:24:34,891, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:24:35,610, WARNING StatReload detected file change in 'db/models.py'. Reloading...
2022-05-26 17:24:35,630, INFO Shutting down
2022-05-26 17:24:35,630, INFO Shutting down
2022-05-26 17:24:35,732, INFO Waiting for application shutdown.
2022-05-26 17:24:35,732, INFO Waiting for application shutdown.
2022-05-26 17:24:35,733, INFO Application shutdown complete.
2022-05-26 17:24:35,733, INFO Application shutdown complete.
2022-05-26 17:24:35,733, INFO Finished server process [1332128]
2022-05-26 17:24:35,733, INFO Finished server process [1332128]
2022-05-26 17:24:37,895, DEBUG Using selector: EpollSelector
2022-05-26 17:24:37,996, INFO Started server process [1343639]
2022-05-26 17:24:37,996, INFO Started server process [1343639]
2022-05-26 17:24:37,996, INFO Waiting for application startup.
2022-05-26 17:24:37,996, INFO Waiting for application startup.
2022-05-26 17:24:37,996, INFO Application startup complete.
2022-05-26 17:24:37,996, INFO Application startup complete.
2022-05-26 17:25:03,767, WARNING StatReload detected file change in 'db/models.py'. Reloading...
2022-05-26 17:25:03,795, INFO Shutting down
2022-05-26 17:25:03,795, INFO Shutting down
2022-05-26 17:25:03,896, INFO Waiting for application shutdown.
2022-05-26 17:25:03,896, INFO Waiting for application shutdown.
2022-05-26 17:25:03,897, INFO Application shutdown complete.
2022-05-26 17:25:03,897, INFO Application shutdown complete.
2022-05-26 17:25:03,897, INFO Finished server process [1343639]
2022-05-26 17:25:03,897, INFO Finished server process [1343639]
2022-05-26 17:25:06,126, DEBUG Using selector: EpollSelector
2022-05-26 17:25:06,237, INFO Started server process [1344365]
2022-05-26 17:25:06,237, INFO Started server process [1344365]
2022-05-26 17:25:06,238, INFO Waiting for application startup.
2022-05-26 17:25:06,238, INFO Waiting for application startup.
2022-05-26 17:25:06,238, INFO Application startup complete.
2022-05-26 17:25:06,238, INFO Application startup complete.
2022-05-26 17:25:26,338, DEBUG Starting new HTTP connection (1): 127.0.0.1:8080
2022-05-26 17:25:26,338, DEBUG Starting new HTTP connection (1): 127.0.0.1:8080
2022-05-26 17:25:30,021, DEBUG http://127.0.0.1:8080 "POST /api/v0/generate HTTP/1.1" 200 309
2022-05-26 17:25:30,021, DEBUG http://127.0.0.1:8080 "POST /api/v0/generate HTTP/1.1" 200 309
2022-05-26 17:25:48,419, DEBUG Starting new HTTP connection (1): 127.0.0.1:8080
2022-05-26 17:25:48,419, DEBUG Starting new HTTP connection (1): 127.0.0.1:8080
2022-05-26 17:25:52,667, DEBUG http://127.0.0.1:8080 "POST /api/v0/generate HTTP/1.1" 200 319
2022-05-26 17:25:52,667, DEBUG http://127.0.0.1:8080 "POST /api/v0/generate HTTP/1.1" 200 319
2022-05-26 17:26:49,292, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:26:49,292, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:38:14,204, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:38:14,204, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:39:02,365, WARNING StatReload detected file change in 'db/models.py'. Reloading...
2022-05-26 17:39:02,415, INFO Shutting down
2022-05-26 17:39:02,415, INFO Shutting down
2022-05-26 17:39:02,517, INFO Waiting for application shutdown.
2022-05-26 17:39:02,517, INFO Waiting for application shutdown.
2022-05-26 17:39:02,517, INFO Application shutdown complete.
2022-05-26 17:39:02,517, INFO Application shutdown complete.
2022-05-26 17:39:02,518, INFO Finished server process [1344365]
2022-05-26 17:39:02,518, INFO Finished server process [1344365]
2022-05-26 17:39:04,789, DEBUG Using selector: EpollSelector
2022-05-26 17:39:04,886, INFO Started server process [1364122]
2022-05-26 17:39:04,886, INFO Started server process [1364122]
2022-05-26 17:39:04,887, INFO Waiting for application startup.
2022-05-26 17:39:04,887, INFO Waiting for application startup.
2022-05-26 17:39:04,887, INFO Application startup complete.
2022-05-26 17:39:04,887, INFO Application startup complete.
2022-05-26 17:39:18,100, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:39:18,100, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:39:40,391, WARNING StatReload detected file change in 'db/models.py'. Reloading...
2022-05-26 17:39:40,487, INFO Shutting down
2022-05-26 17:39:40,487, INFO Shutting down
2022-05-26 17:39:40,588, INFO Waiting for application shutdown.
2022-05-26 17:39:40,588, INFO Waiting for application shutdown.
2022-05-26 17:39:40,589, INFO Application shutdown complete.
2022-05-26 17:39:40,589, INFO Application shutdown complete.
2022-05-26 17:39:40,590, INFO Finished server process [1364122]
2022-05-26 17:39:40,590, INFO Finished server process [1364122]
2022-05-26 17:39:42,698, DEBUG Using selector: EpollSelector
2022-05-26 17:39:42,846, INFO Started server process [1365153]
2022-05-26 17:39:42,846, INFO Started server process [1365153]
2022-05-26 17:39:42,846, INFO Waiting for application startup.
2022-05-26 17:39:42,846, INFO Waiting for application startup.
2022-05-26 17:39:42,847, INFO Application startup complete.
2022-05-26 17:39:42,847, INFO Application startup complete.
2022-05-26 17:39:44,110, WARNING StatReload detected file change in 'db/models.py'. Reloading...
2022-05-26 17:39:44,150, INFO Shutting down
2022-05-26 17:39:44,150, INFO Shutting down
2022-05-26 17:39:44,250, INFO Waiting for application shutdown.
2022-05-26 17:39:44,250, INFO Waiting for application shutdown.
2022-05-26 17:39:44,251, INFO Application shutdown complete.
2022-05-26 17:39:44,251, INFO Application shutdown complete.
2022-05-26 17:39:44,251, INFO Finished server process [1365153]
2022-05-26 17:39:44,251, INFO Finished server process [1365153]
2022-05-26 17:39:46,237, DEBUG Using selector: EpollSelector
2022-05-26 17:39:46,332, INFO Started server process [1365301]
2022-05-26 17:39:46,332, INFO Started server process [1365301]
2022-05-26 17:39:46,332, INFO Waiting for application startup.
2022-05-26 17:39:46,332, INFO Waiting for application startup.
2022-05-26 17:39:46,332, INFO Application startup complete.
2022-05-26 17:39:46,332, INFO Application startup complete.
2022-05-26 17:40:17,821, WARNING StatReload detected file change in 'db/models.py'. Reloading...
2022-05-26 17:40:17,911, INFO Shutting down
2022-05-26 17:40:17,911, INFO Shutting down
2022-05-26 17:40:18,011, INFO Waiting for application shutdown.
2022-05-26 17:40:18,011, INFO Waiting for application shutdown.
2022-05-26 17:40:18,012, INFO Application shutdown complete.
2022-05-26 17:40:18,012, INFO Application shutdown complete.
2022-05-26 17:40:18,012, INFO Finished server process [1365301]
2022-05-26 17:40:18,012, INFO Finished server process [1365301]
2022-05-26 17:40:20,050, DEBUG Using selector: EpollSelector
2022-05-26 17:40:20,147, INFO Started server process [1366151]
2022-05-26 17:40:20,147, INFO Started server process [1366151]
2022-05-26 17:40:20,147, INFO Waiting for application startup.
2022-05-26 17:40:20,147, INFO Waiting for application startup.
2022-05-26 17:40:20,148, INFO Application startup complete.
2022-05-26 17:40:20,148, INFO Application startup complete.
2022-05-26 17:40:31,244, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:40:31,244, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:40:56,851, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:40:56,851, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:41:15,921, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:41:15,921, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:41:18,623, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:41:18,623, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:41:21,698, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:41:21,698, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:41:24,364, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:41:24,364, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:41:27,150, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:41:27,150, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:41:29,957, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:41:29,957, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:41:32,847, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:41:32,847, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:43:14,178, WARNING StatReload detected file change in 'schemas/models.py'. Reloading...
2022-05-26 17:43:14,200, INFO Shutting down
2022-05-26 17:43:14,200, INFO Shutting down
2022-05-26 17:43:14,300, INFO Waiting for application shutdown.
2022-05-26 17:43:14,300, INFO Waiting for application shutdown.
2022-05-26 17:43:14,300, INFO Application shutdown complete.
2022-05-26 17:43:14,300, INFO Application shutdown complete.
2022-05-26 17:43:14,301, INFO Finished server process [1366151]
2022-05-26 17:43:14,301, INFO Finished server process [1366151]
2022-05-26 17:43:16,526, DEBUG Using selector: EpollSelector
2022-05-26 17:43:16,628, INFO Started server process [1370834]
2022-05-26 17:43:16,628, INFO Started server process [1370834]
2022-05-26 17:43:16,628, INFO Waiting for application startup.
2022-05-26 17:43:16,628, INFO Waiting for application startup.
2022-05-26 17:43:16,628, INFO Application startup complete.
2022-05-26 17:43:16,628, INFO Application startup complete.
2022-05-26 17:43:21,370, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 559, in pydantic.main.BaseModel.from_orm
pydantic.errors.ConfigError: You must have the config attribute orm_mode=True to use from_orm
2022-05-26 17:43:21,370, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 559, in pydantic.main.BaseModel.from_orm
pydantic.errors.ConfigError: You must have the config attribute orm_mode=True to use from_orm
2022-05-26 17:43:45,984, WARNING StatReload detected file change in 'schemas/models.py'. Reloading...
2022-05-26 17:43:46,047, INFO Shutting down
2022-05-26 17:43:46,047, INFO Shutting down
2022-05-26 17:43:46,148, INFO Waiting for application shutdown.
2022-05-26 17:43:46,148, INFO Waiting for application shutdown.
2022-05-26 17:43:46,149, INFO Application shutdown complete.
2022-05-26 17:43:46,149, INFO Application shutdown complete.
2022-05-26 17:43:46,149, INFO Finished server process [1370834]
2022-05-26 17:43:46,149, INFO Finished server process [1370834]
2022-05-26 17:43:48,352, DEBUG Using selector: EpollSelector
2022-05-26 17:43:48,459, INFO Started server process [1371638]
2022-05-26 17:43:48,459, INFO Started server process [1371638]
2022-05-26 17:43:48,459, INFO Waiting for application startup.
2022-05-26 17:43:48,459, INFO Waiting for application startup.
2022-05-26 17:43:48,459, INFO Application startup complete.
2022-05-26 17:43:48,459, INFO Application startup complete.
2022-05-26 17:44:04,762, WARNING StatReload detected file change in 'schemas/models.py'. Reloading...
2022-05-26 17:44:04,821, INFO Shutting down
2022-05-26 17:44:04,821, INFO Shutting down
2022-05-26 17:44:04,922, INFO Waiting for application shutdown.
2022-05-26 17:44:04,922, INFO Waiting for application shutdown.
2022-05-26 17:44:04,923, INFO Application shutdown complete.
2022-05-26 17:44:04,923, INFO Application shutdown complete.
2022-05-26 17:44:04,923, INFO Finished server process [1371638]
2022-05-26 17:44:04,923, INFO Finished server process [1371638]
2022-05-26 17:44:07,071, DEBUG Using selector: EpollSelector
2022-05-26 17:44:07,217, INFO Started server process [1372139]
2022-05-26 17:44:07,217, INFO Started server process [1372139]
2022-05-26 17:44:07,217, INFO Waiting for application startup.
2022-05-26 17:44:07,217, INFO Waiting for application startup.
2022-05-26 17:44:07,218, INFO Application startup complete.
2022-05-26 17:44:07,218, INFO Application startup complete.
2022-05-26 17:44:13,859, WARNING StatReload detected file change in 'schemas/models.py'. Reloading...
2022-05-26 17:44:13,944, INFO Shutting down
2022-05-26 17:44:13,944, INFO Shutting down
2022-05-26 17:44:14,045, INFO Waiting for application shutdown.
2022-05-26 17:44:14,045, INFO Waiting for application shutdown.
2022-05-26 17:44:14,045, INFO Application shutdown complete.
2022-05-26 17:44:14,045, INFO Application shutdown complete.
2022-05-26 17:44:14,046, INFO Finished server process [1372139]
2022-05-26 17:44:14,046, INFO Finished server process [1372139]
2022-05-26 17:44:16,260, DEBUG Using selector: EpollSelector
2022-05-26 17:44:16,357, INFO Started server process [1372419]
2022-05-26 17:44:16,357, INFO Started server process [1372419]
2022-05-26 17:44:16,357, INFO Waiting for application startup.
2022-05-26 17:44:16,357, INFO Waiting for application startup.
2022-05-26 17:44:16,357, INFO Application startup complete.
2022-05-26 17:44:16,357, INFO Application startup complete.
2022-05-26 17:44:21,088, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:44:21,088, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:48:23,996, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 17:48:23,996, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 19:00:01,091, WARNING StatReload detected file change in 'dal.py'. Reloading...
2022-05-26 19:00:01,151, INFO Shutting down
2022-05-26 19:00:01,151, INFO Shutting down
2022-05-26 19:00:01,252, INFO Waiting for application shutdown.
2022-05-26 19:00:01,252, INFO Waiting for application shutdown.
2022-05-26 19:00:01,253, INFO Application shutdown complete.
2022-05-26 19:00:01,253, INFO Application shutdown complete.
2022-05-26 19:00:01,253, INFO Finished server process [1372419]
2022-05-26 19:00:01,253, INFO Finished server process [1372419]
2022-05-26 19:00:03,476, DEBUG Using selector: EpollSelector
2022-05-26 19:00:03,576, INFO Started server process [1483467]
2022-05-26 19:00:03,576, INFO Started server process [1483467]
2022-05-26 19:00:03,576, INFO Waiting for application startup.
2022-05-26 19:00:03,576, INFO Waiting for application startup.
2022-05-26 19:00:03,577, INFO Application startup complete.
2022-05-26 19:00:03,577, INFO Application startup complete.
2022-05-26 19:00:54,965, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 19:00:54,965, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 385, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 19:03:53,906, WARNING StatReload detected file change in 'dal.py'. Reloading...
2022-05-26 19:03:53,989, INFO Shutting down
2022-05-26 19:03:53,989, INFO Shutting down
2022-05-26 19:03:54,089, INFO Waiting for application shutdown.
2022-05-26 19:03:54,089, INFO Waiting for application shutdown.
2022-05-26 19:03:54,090, INFO Application shutdown complete.
2022-05-26 19:03:54,090, INFO Application shutdown complete.
2022-05-26 19:03:54,090, INFO Finished server process [1483467]
2022-05-26 19:03:54,090, INFO Finished server process [1483467]
2022-05-26 19:03:56,408, DEBUG Using selector: EpollSelector
2022-05-26 19:03:56,506, INFO Started server process [1489708]
2022-05-26 19:03:56,506, INFO Started server process [1489708]
2022-05-26 19:03:56,506, INFO Waiting for application startup.
2022-05-26 19:03:56,506, INFO Waiting for application startup.
2022-05-26 19:03:56,506, INFO Application startup complete.
2022-05-26 19:03:56,506, INFO Application startup complete.
2022-05-26 19:04:13,571, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 19:04:13,571, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
2022-05-26 19:09:51,971, DEBUG Starting new HTTP connection (1): 127.0.0.1:8080
2022-05-26 19:09:51,971, DEBUG Starting new HTTP connection (1): 127.0.0.1:8080
2022-05-26 19:09:53,138, DEBUG http://127.0.0.1:8080 "POST /api/v0/generate HTTP/1.1" 200 129
2022-05-26 19:09:53,138, DEBUG http://127.0.0.1:8080 "POST /api/v0/generate HTTP/1.1" 200 129
2022-05-26 19:10:11,729, DEBUG Starting new HTTP connection (1): 127.0.0.1:8080
2022-05-26 19:10:11,729, DEBUG Starting new HTTP connection (1): 127.0.0.1:8080
2022-05-26 19:10:16,074, DEBUG http://127.0.0.1:8080 "POST /api/v0/generate HTTP/1.1" 200 285
2022-05-26 19:10:16,074, DEBUG http://127.0.0.1:8080 "POST /api/v0/generate HTTP/1.1" 200 285
2022-05-26 20:59:04,913, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "/data1/work/repos/light_chat/main.py", line 214, in pop_message
    rst = await dal.pop_user_message(db, current_userid, start_id)
  File "/data1/work/repos/light_chat/dal.py", line 454, in pop_user_message
    engine = PromptEngine('', userid, db)
  File "/data1/work/repos/light_chat/chat_bot_gpt3.py", line 87, in __init__
    hist_msgs = dal.get_hist_message(db, userid, 0, hist_wind)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 112, in dispatch_line
    self.user_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 262, in user_line
    self.interaction(frame, None)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 357, in interaction
    self._cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 322, in _cmdloop
    self.cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/cmd.py", line 126, in cmdloop
    line = input(self.prompt)
OSError: [Errno 9] Bad file descriptor
2022-05-26 20:59:04,913, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "/data1/work/repos/light_chat/main.py", line 214, in pop_message
    rst = await dal.pop_user_message(db, current_userid, start_id)
  File "/data1/work/repos/light_chat/dal.py", line 454, in pop_user_message
    engine = PromptEngine('', userid, db)
  File "/data1/work/repos/light_chat/chat_bot_gpt3.py", line 87, in __init__
    hist_msgs = dal.get_hist_message(db, userid, 0, hist_wind)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 112, in dispatch_line
    self.user_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 262, in user_line
    self.interaction(frame, None)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 357, in interaction
    self._cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 322, in _cmdloop
    self.cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/cmd.py", line 126, in cmdloop
    line = input(self.prompt)
OSError: [Errno 9] Bad file descriptor
2022-05-26 20:59:04,936, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 112, in dispatch_line
    self.user_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 262, in user_line
    self.interaction(frame, None)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 357, in interaction
    self._cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 322, in _cmdloop
    self.cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/cmd.py", line 126, in cmdloop
    line = input(self.prompt)
OSError: [Errno 9] Bad file descriptor
2022-05-26 20:59:04,936, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 112, in dispatch_line
    self.user_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 262, in user_line
    self.interaction(frame, None)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 357, in interaction
    self._cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 322, in _cmdloop
    self.cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/cmd.py", line 126, in cmdloop
    line = input(self.prompt)
OSError: [Errno 9] Bad file descriptor
2022-05-26 20:59:16,434, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 112, in dispatch_line
    self.user_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 262, in user_line
    self.interaction(frame, None)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 357, in interaction
    self._cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 322, in _cmdloop
    self.cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/cmd.py", line 126, in cmdloop
    line = input(self.prompt)
OSError: [Errno 9] Bad file descriptor
2022-05-26 20:59:16,434, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 112, in dispatch_line
    self.user_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 262, in user_line
    self.interaction(frame, None)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 357, in interaction
    self._cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 322, in _cmdloop
    self.cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/cmd.py", line 126, in cmdloop
    line = input(self.prompt)
OSError: [Errno 9] Bad file descriptor
2022-05-26 20:59:16,547, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "/data1/work/repos/light_chat/main.py", line 214, in pop_message
    rst = await dal.pop_user_message(db, current_userid, start_id)
  File "/data1/work/repos/light_chat/dal.py", line 454, in pop_user_message
    engine = PromptEngine('', userid, db)
  File "/data1/work/repos/light_chat/chat_bot_gpt3.py", line 87, in __init__
    hist_msgs = dal.get_hist_message(db, userid, 0, hist_wind)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 112, in dispatch_line
    self.user_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 262, in user_line
    self.interaction(frame, None)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 357, in interaction
    self._cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 322, in _cmdloop
    self.cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/cmd.py", line 126, in cmdloop
    line = input(self.prompt)
OSError: [Errno 9] Bad file descriptor
2022-05-26 20:59:16,547, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "/data1/work/repos/light_chat/main.py", line 214, in pop_message
    rst = await dal.pop_user_message(db, current_userid, start_id)
  File "/data1/work/repos/light_chat/dal.py", line 454, in pop_user_message
    engine = PromptEngine('', userid, db)
  File "/data1/work/repos/light_chat/chat_bot_gpt3.py", line 87, in __init__
    hist_msgs = dal.get_hist_message(db, userid, 0, hist_wind)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 112, in dispatch_line
    self.user_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 262, in user_line
    self.interaction(frame, None)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 357, in interaction
    self._cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 322, in _cmdloop
    self.cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/cmd.py", line 126, in cmdloop
    line = input(self.prompt)
OSError: [Errno 9] Bad file descriptor
2022-05-26 20:59:30,343, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 112, in dispatch_line
    self.user_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 262, in user_line
    self.interaction(frame, None)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 357, in interaction
    self._cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 322, in _cmdloop
    self.cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/cmd.py", line 126, in cmdloop
    line = input(self.prompt)
OSError: [Errno 9] Bad file descriptor
2022-05-26 20:59:30,343, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 112, in dispatch_line
    self.user_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 262, in user_line
    self.interaction(frame, None)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 357, in interaction
    self._cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 322, in _cmdloop
    self.cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/cmd.py", line 126, in cmdloop
    line = input(self.prompt)
OSError: [Errno 9] Bad file descriptor
2022-05-26 20:59:30,437, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "/data1/work/repos/light_chat/main.py", line 214, in pop_message
    rst = await dal.pop_user_message(db, current_userid, start_id)
  File "/data1/work/repos/light_chat/dal.py", line 454, in pop_user_message
    engine = PromptEngine('', userid, db)
  File "/data1/work/repos/light_chat/chat_bot_gpt3.py", line 87, in __init__
    hist_msgs = dal.get_hist_message(db, userid, 0, hist_wind)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 112, in dispatch_line
    self.user_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 262, in user_line
    self.interaction(frame, None)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 357, in interaction
    self._cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 322, in _cmdloop
    self.cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/cmd.py", line 126, in cmdloop
    line = input(self.prompt)
OSError: [Errno 9] Bad file descriptor
2022-05-26 20:59:30,437, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "/data1/work/repos/light_chat/main.py", line 214, in pop_message
    rst = await dal.pop_user_message(db, current_userid, start_id)
  File "/data1/work/repos/light_chat/dal.py", line 454, in pop_user_message
    engine = PromptEngine('', userid, db)
  File "/data1/work/repos/light_chat/chat_bot_gpt3.py", line 87, in __init__
    hist_msgs = dal.get_hist_message(db, userid, 0, hist_wind)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 112, in dispatch_line
    self.user_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 262, in user_line
    self.interaction(frame, None)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 357, in interaction
    self._cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 322, in _cmdloop
    self.cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/cmd.py", line 126, in cmdloop
    line = input(self.prompt)
OSError: [Errno 9] Bad file descriptor
2022-05-26 20:59:34,951, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 112, in dispatch_line
    self.user_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 262, in user_line
    self.interaction(frame, None)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 357, in interaction
    self._cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 322, in _cmdloop
    self.cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/cmd.py", line 126, in cmdloop
    line = input(self.prompt)
OSError: [Errno 9] Bad file descriptor
2022-05-26 20:59:34,951, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 112, in dispatch_line
    self.user_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 262, in user_line
    self.interaction(frame, None)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 357, in interaction
    self._cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 322, in _cmdloop
    self.cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/cmd.py", line 126, in cmdloop
    line = input(self.prompt)
OSError: [Errno 9] Bad file descriptor
2022-05-26 20:59:34,997, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "/data1/work/repos/light_chat/main.py", line 214, in pop_message
    rst = await dal.pop_user_message(db, current_userid, start_id)
  File "/data1/work/repos/light_chat/dal.py", line 454, in pop_user_message
    engine = PromptEngine('', userid, db)
  File "/data1/work/repos/light_chat/chat_bot_gpt3.py", line 87, in __init__
    hist_msgs = dal.get_hist_message(db, userid, 0, hist_wind)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 112, in dispatch_line
    self.user_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 262, in user_line
    self.interaction(frame, None)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 357, in interaction
    self._cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 322, in _cmdloop
    self.cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/cmd.py", line 126, in cmdloop
    line = input(self.prompt)
OSError: [Errno 9] Bad file descriptor
2022-05-26 20:59:34,997, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 96, in __call__
    raise exc from None
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/debug.py", line 93, in __call__
    await self.app(scope, receive, inner_send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "/data1/work/repos/light_chat/main.py", line 214, in pop_message
    rst = await dal.pop_user_message(db, current_userid, start_id)
  File "/data1/work/repos/light_chat/dal.py", line 454, in pop_user_message
    engine = PromptEngine('', userid, db)
  File "/data1/work/repos/light_chat/chat_bot_gpt3.py", line 87, in __init__
    hist_msgs = dal.get_hist_message(db, userid, 0, hist_wind)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/repos/light_chat/dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 112, in dispatch_line
    self.user_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 262, in user_line
    self.interaction(frame, None)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 357, in interaction
    self._cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/pdb.py", line 322, in _cmdloop
    self.cmdloop()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/cmd.py", line 126, in cmdloop
    line = input(self.prompt)
OSError: [Errno 9] Bad file descriptor
2022-05-26 21:01:03,265, WARNING StatReload detected file change in 'dal.py'. Reloading...
2022-05-26 21:01:03,277, INFO Shutting down
2022-05-26 21:01:03,277, INFO Shutting down
2022-05-26 21:01:03,377, INFO Waiting for application shutdown.
2022-05-26 21:01:03,377, INFO Waiting for application shutdown.
2022-05-26 21:01:03,378, INFO Application shutdown complete.
2022-05-26 21:01:03,378, INFO Application shutdown complete.
2022-05-26 21:01:03,378, INFO Finished server process [1489708]
2022-05-26 21:01:03,378, INFO Finished server process [1489708]
2022-05-26 21:01:05,619, DEBUG Using selector: EpollSelector
2022-05-26 21:01:05,720, INFO Started server process [1653455]
2022-05-26 21:01:05,720, INFO Started server process [1653455]
2022-05-26 21:01:05,720, INFO Waiting for application startup.
2022-05-26 21:01:05,720, INFO Waiting for application startup.
2022-05-26 21:01:05,720, INFO Application startup complete.
2022-05-26 21:01:05,720, INFO Application startup complete.
2022-05-26 21:03:34,906, INFO Will watch for changes in these directories: ['/data1/work/repos/light_chat']
2022-05-26 21:03:34,906, ERROR [Errno 98] Address already in use
2022-05-26 21:04:02,085, INFO Shutting down
2022-05-26 21:04:02,085, INFO Shutting down
2022-05-26 21:04:02,187, INFO Waiting for application shutdown.
2022-05-26 21:04:02,187, INFO Waiting for application shutdown.
2022-05-26 21:04:02,188, INFO Application shutdown complete.
2022-05-26 21:04:02,188, INFO Application shutdown complete.
2022-05-26 21:04:02,188, INFO Finished server process [1653455]
2022-05-26 21:04:02,188, INFO Finished server process [1653455]
2022-05-26 21:04:08,887, INFO Will watch for changes in these directories: ['/data1/work/repos/light_chat']
2022-05-26 21:04:08,888, INFO Uvicorn running on http://0.0.0.0:9090 (Press CTRL+C to quit)
2022-05-26 21:04:08,888, INFO Started reloader process [1658415] using statreload
2022-05-26 21:04:20,675, INFO Will watch for changes in these directories: ['/data1/work/repos/light_chat']
2022-05-26 21:04:20,676, INFO Uvicorn running on http://0.0.0.0:9090 (Press CTRL+C to quit)
2022-05-26 21:04:20,676, INFO Started reloader process [1658788] using statreload
2022-05-26 21:05:03,713, INFO Will watch for changes in these directories: ['/data1/work/repos/light_chat']
2022-05-26 21:05:03,714, INFO Uvicorn running on http://0.0.0.0:9090 (Press CTRL+C to quit)
2022-05-26 21:05:03,714, INFO Started reloader process [1659913] using statreload
2022-05-26 21:05:35,008, INFO Will watch for changes in these directories: ['/data1/work/repos/light_chat']
2022-05-26 21:05:35,009, INFO Uvicorn running on http://0.0.0.0:9090 (Press CTRL+C to quit)
2022-05-26 21:05:35,009, INFO Started reloader process [1660744] using statreload
2022-05-26 21:06:16,137, INFO Started server process [1661839]
2022-05-26 21:06:16,137, INFO Waiting for application startup.
2022-05-26 21:06:16,138, INFO Application startup complete.
2022-05-26 21:06:16,138, INFO Uvicorn running on http://0.0.0.0:9090 (Press CTRL+C to quit)
2022-05-26 21:10:43,711, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/streams/memory.py", line 81, in receive
    return self.receive_nowait()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/streams/memory.py", line 76, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 41, in call_next
    message = await recv_stream.receive()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/streams/memory.py", line 101, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/./main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "/data1/work/repos/light_chat/./main.py", line 214, in pop_message
    rst = await dal.pop_user_message(db, current_userid, start_id)
  File "/data1/work/repos/light_chat/./dal.py", line 454, in pop_user_message
    engine = PromptEngine('', userid, db)
  File "/data1/work/repos/light_chat/./chat_bot_gpt3.py", line 87, in __init__
    hist_msgs = dal.get_hist_message(db, userid, 0, hist_wind)
  File "/data1/work/repos/light_chat/./dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 21:10:46,282, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/streams/memory.py", line 81, in receive
    return self.receive_nowait()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/streams/memory.py", line 76, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 41, in call_next
    message = await recv_stream.receive()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/streams/memory.py", line 101, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/./main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/./main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/./dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "pydantic/main.py", line 564, in pydantic.main.BaseModel.from_orm
pydantic.error_wrappers.ValidationError: 1 validation error for MessageOut
content
  field required (type=value_error.missing)
2022-05-26 21:10:48,490, ERROR Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/asyncio/base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/selectors.py", line 471, in select
    for fd, event in fd_event_list:
  File "/data1/work/.conda/envs/nlp/lib/python3.8/selectors.py", line 471, in select
    for fd, event in fd_event_list:
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 624, in lifespan
    await receive()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/lifespan/on.py", line 135, in receive
    return await self.receive_queue.get()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/asyncio/queues.py", line 163, in get
    await getter
asyncio.exceptions.CancelledError

2022-05-26 21:12:54,291, INFO Started server process [1671938]
2022-05-26 21:12:54,292, INFO Waiting for application startup.
2022-05-26 21:12:54,292, INFO Application startup complete.
2022-05-26 21:12:54,292, INFO Uvicorn running on http://0.0.0.0:9090 (Press CTRL+C to quit)
2022-05-26 21:14:38,318, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/streams/memory.py", line 81, in receive
    return self.receive_nowait()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/streams/memory.py", line 76, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 41, in call_next
    message = await recv_stream.receive()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/streams/memory.py", line 101, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/./main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "/data1/work/repos/light_chat/./main.py", line 214, in pop_message
    rst = await dal.pop_user_message(db, current_userid, start_id)
  File "/data1/work/repos/light_chat/./dal.py", line 454, in pop_user_message
    engine = PromptEngine('', userid, db)
  File "/data1/work/repos/light_chat/./chat_bot_gpt3.py", line 87, in __init__
    hist_msgs = dal.get_hist_message(db, userid, 0, hist_wind)
  File "/data1/work/repos/light_chat/./dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/repos/light_chat/./dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2022-05-26 21:14:38,324, INFO Shutting down
2022-05-26 21:14:38,325, ERROR Exception in ASGI application
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/streams/memory.py", line 81, in receive
    return self.receive_nowait()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/streams/memory.py", line 76, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 41, in call_next
    message = await recv_stream.receive()
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/streams/memory.py", line 101, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 372, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 181, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 63, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/data1/work/repos/light_chat/./main.py", line 60, in db_session_middleware
    response = await call_next(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 44, in call_next
    raise app_exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/base.py", line 34, in coro
    await self.app(scope, request.receive, send_stream.send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 82, in __call__
    raise exc
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__
    raise e
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/routing.py", line 61, in app
    response = await func(request)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/fastapi/routing.py", line 162, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/to_thread.py", line 28, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(func, *args, cancellable=cancellable,
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 818, in run_sync_in_worker_thread
    return await future
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/anyio/_backends/_asyncio.py", line 754, in run
    result = context.run(func, *args)
  File "/data1/work/repos/light_chat/./main.py", line 181, in hist_message
    return dal.get_hist_message(db, current_user, start_id, limit)
  File "/data1/work/repos/light_chat/./dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/repos/light_chat/./dal.py", line 386, in get_hist_message
    hist = schemas.MessageOut.from_orm(db_hist)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/data1/work/.conda/envs/nlp/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2022-05-26 21:14:38,425, INFO Waiting for application shutdown.
2022-05-26 21:14:38,426, INFO Application shutdown complete.
2022-05-26 21:14:38,426, INFO Finished server process [1671938]
2022-05-26 21:17:57,910, INFO Started server process [1679797]
2022-05-26 21:17:57,911, INFO Waiting for application startup.
2022-05-26 21:17:57,911, INFO Application startup complete.
2022-05-26 21:17:57,911, INFO Uvicorn running on http://0.0.0.0:9090 (Press CTRL+C to quit)
2022-05-26 21:18:04,130, INFO Shutting down
2022-05-26 21:18:04,231, INFO Waiting for application shutdown.
2022-05-26 21:18:04,232, INFO Application shutdown complete.
2022-05-26 21:18:04,232, INFO Finished server process [1679797]
2022-05-26 21:18:10,756, INFO Started server process [1680220]
2022-05-26 21:18:10,772, INFO Waiting for application startup.
2022-05-26 21:18:10,772, INFO Application startup complete.
2022-05-26 21:18:10,772, INFO Uvicorn running on http://0.0.0.0:9090 (Press CTRL+C to quit)
2022-05-26 23:43:55,100, WARNING Invalid HTTP request received.
Traceback (most recent call last):
  File "/data1/work/.conda/envs/nlp/lib/python3.8/site-packages/uvicorn/protocols/http/httptools_impl.py", line 124, in data_received
    self.parser.feed_data(data)
  File "httptools/parser/parser.pyx", line 212, in httptools.parser.parser.HttpParser.feed_data
httptools.parser.errors.HttpParserInvalidMethodError: Invalid method encountered
